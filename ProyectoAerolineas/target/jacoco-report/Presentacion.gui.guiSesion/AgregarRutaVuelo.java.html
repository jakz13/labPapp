<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="es"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AgregarRutaVuelo.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">MiProyectoSwing</a> &gt; <a href="index.source.html" class="el_package">Presentacion.gui.guiSesion</a> &gt; <span class="el_source">AgregarRutaVuelo.java</span></div><h1>AgregarRutaVuelo.java</h1><pre class="source lang-java linenums">package Presentacion.gui.guiSesion;

import DataTypes.DtAerolinea;
import DataTypes.DtRutaVuelo;
import DataTypes.DtPaquete;
import logica.Fabrica;
import logica.ISistema;
import logica.TipoAsiento;

import javax.swing.*;
import java.awt.*;

public class AgregarRutaVuelo {
    private JComboBox&lt;DtPaquete&gt; campoPaquete;
    private JComboBox&lt;DtAerolinea&gt; campoAerolinea;
    private JList&lt;DtRutaVuelo&gt; campoRutaVuelo;
    private JComboBox&lt;TipoAsiento&gt; campoTipoAsiento;
    private JTextField campoCantidadAsiento;
    private JButton añadirButton;
    private JButton cancelarButton;
    private JPanel JPanelAgregar;

<span class="nc" id="L23">    public AgregarRutaVuelo() {</span>
<span class="nc" id="L24">        ISistema sistema = Fabrica.getInstance().getISistema();</span>

        // Cargar los paquetes, aerolíneas y tipos de asiento al iniciar
<span class="nc" id="L27">        cargarPaquetes();</span>
<span class="nc" id="L28">        cargarAerolineas();</span>
<span class="nc" id="L29">        cargarTipoAsiento();</span>

        // Actualizar la lista de rutas cuando se selecciona otra aerolínea
<span class="nc" id="L32">        campoAerolinea.addActionListener(e -&gt; actualizarRutas());</span>

        // Acción del botón Añadir
<span class="nc" id="L35">        añadirButton.addActionListener(e -&gt; {</span>
<span class="nc" id="L36">            DtPaquete paquete = (DtPaquete) campoPaquete.getSelectedItem();</span>
<span class="nc" id="L37">            DtAerolinea aerolinea = (DtAerolinea) campoAerolinea.getSelectedItem();</span>
<span class="nc" id="L38">            DtRutaVuelo rutaVuelo = (DtRutaVuelo) campoRutaVuelo.getSelectedValue();</span>
<span class="nc" id="L39">            TipoAsiento tipoAsiento = (TipoAsiento) campoTipoAsiento.getSelectedItem();</span>
<span class="nc" id="L40">            String cantidadAsientoStr = campoCantidadAsiento.getText().trim();</span>

            // Validar campos específicos
<span class="nc bnc" id="L43" title="All 2 branches missed.">            if (paquete == null) {</span>
<span class="nc" id="L44">                JOptionPane.showMessageDialog(null,</span>
                        &quot;Debe seleccionar un paquete.&quot;,
                        &quot;Error&quot;,
                        JOptionPane.ERROR_MESSAGE);
<span class="nc" id="L48">                return;</span>
            }

<span class="nc bnc" id="L51" title="All 2 branches missed.">            if (aerolinea == null) {</span>
<span class="nc" id="L52">                JOptionPane.showMessageDialog(null,</span>
                        &quot;Debe seleccionar una aerolínea.&quot;,
                        &quot;Error&quot;,
                        JOptionPane.ERROR_MESSAGE);
<span class="nc" id="L56">                return;</span>
            }

<span class="nc bnc" id="L59" title="All 2 branches missed.">            if (rutaVuelo == null) {</span>
<span class="nc" id="L60">                JOptionPane.showMessageDialog(null,</span>
                        &quot;Debe seleccionar una ruta de vuelo.&quot;,
                        &quot;Error&quot;,
                        JOptionPane.ERROR_MESSAGE);
<span class="nc" id="L64">                return;</span>
            }

<span class="nc bnc" id="L67" title="All 2 branches missed.">            if (tipoAsiento == null) {</span>
<span class="nc" id="L68">                JOptionPane.showMessageDialog(null,</span>
                        &quot;Debe seleccionar un tipo de asiento.&quot;,
                        &quot;Error&quot;,
                        JOptionPane.ERROR_MESSAGE);
<span class="nc" id="L72">                return;</span>
            }

<span class="nc bnc" id="L75" title="All 2 branches missed.">            if (cantidadAsientoStr.isEmpty()) {</span>
<span class="nc" id="L76">                JOptionPane.showMessageDialog(null,</span>
                        &quot;Debe ingresar la cantidad de asientos.&quot;,
                        &quot;Error&quot;,
                        JOptionPane.ERROR_MESSAGE);
<span class="nc" id="L80">                return;</span>
            }

            int cantidadAsiento;
            try {
<span class="nc" id="L85">                cantidadAsiento = Integer.parseInt(cantidadAsientoStr);</span>
<span class="nc bnc" id="L86" title="All 2 branches missed.">                if (cantidadAsiento &lt;= 0) {</span>
<span class="nc" id="L87">                    JOptionPane.showMessageDialog(null,</span>
                            &quot;La cantidad de asientos debe ser mayor a 0.&quot;,
                            &quot;Error&quot;,
                            JOptionPane.ERROR_MESSAGE);
<span class="nc" id="L91">                    return;</span>
                }
<span class="nc" id="L93">            } catch (NumberFormatException ex) {</span>
<span class="nc" id="L94">                JOptionPane.showMessageDialog(null,</span>
                        &quot;La cantidad de asientos debe ser un número entero válido.&quot;,
                        &quot;Error&quot;,
                        JOptionPane.ERROR_MESSAGE);
<span class="nc" id="L98">                return;</span>
<span class="nc" id="L99">            }</span>

            try {
<span class="nc" id="L102">                sistema.altaRutaPaquete(paquete.getNombre(), rutaVuelo.getNombre(), cantidadAsiento, tipoAsiento);</span>
<span class="nc" id="L103">                JOptionPane.showMessageDialog(null,</span>
                        &quot;Ruta de vuelo agregada correctamente al paquete.&quot;,
                        &quot;Éxito&quot;,
                        JOptionPane.INFORMATION_MESSAGE);

                // Limpiar campos después del éxito
<span class="nc" id="L109">                campoCantidadAsiento.setText(&quot;&quot;);</span>
<span class="nc" id="L110">                campoRutaVuelo.clearSelection();</span>

<span class="nc" id="L112">            } catch (IllegalArgumentException ex) {</span>
<span class="nc" id="L113">                JOptionPane.showMessageDialog(null,</span>
<span class="nc" id="L114">                        ex.getMessage(),</span>
                        &quot;Error&quot;,
                        JOptionPane.ERROR_MESSAGE);
<span class="nc" id="L117">            } catch (Exception ex) {</span>
<span class="nc" id="L118">                JOptionPane.showMessageDialog(null,</span>
<span class="nc" id="L119">                        &quot;Error inesperado al agregar la ruta: &quot; + ex.getMessage(),</span>
                        &quot;Error&quot;,
                        JOptionPane.ERROR_MESSAGE);
<span class="nc" id="L122">            }</span>
<span class="nc" id="L123">        });</span>

        // Acción del botón Cancelar
<span class="nc" id="L126">        cancelarButton.addActionListener(e -&gt; {</span>
<span class="nc" id="L127">            JFrame topFrame = (JFrame) SwingUtilities.getWindowAncestor(campoPaquete);</span>
<span class="nc bnc" id="L128" title="All 2 branches missed.">            if (topFrame != null) {</span>
<span class="nc" id="L129">                topFrame.dispose();</span>
            }
<span class="nc" id="L131">        });</span>
<span class="nc" id="L132">    }</span>

    // Carga paquetes disponibles
    private void cargarPaquetes() {
<span class="nc" id="L136">        ISistema sistema = Fabrica.getInstance().getISistema();</span>
<span class="nc" id="L137">        DefaultComboBoxModel&lt;DtPaquete&gt; modeloPaquetes = new DefaultComboBoxModel&lt;&gt;();</span>

<span class="nc bnc" id="L139" title="All 2 branches missed.">        for (DtPaquete p : sistema.getPaquetesDisp()) {</span>
<span class="nc" id="L140">            modeloPaquetes.addElement(p);</span>
<span class="nc" id="L141">        }</span>

<span class="nc" id="L143">        campoPaquete.setModel(modeloPaquetes);</span>
<span class="nc" id="L144">        campoPaquete.setSelectedIndex(-1);</span>

        // Listener opcional para mostrar detalle en otro componente
<span class="nc" id="L147">        campoPaquete.addActionListener(e -&gt; {</span>
<span class="nc" id="L148">            DtPaquete seleccionado = (DtPaquete) campoPaquete.getSelectedItem();</span>
<span class="nc bnc" id="L149" title="All 2 branches missed.">            if (seleccionado != null) {</span>
                // Mostrar detalles en un TextArea, Label o popup
<span class="nc" id="L151">                System.out.println(seleccionado.toString());</span>
            }
<span class="nc" id="L153">        });</span>
<span class="nc" id="L154">    }</span>


    private void cargarAerolineas() {
<span class="nc" id="L158">        ISistema sistema = Fabrica.getInstance().getISistema();</span>
<span class="nc" id="L159">        DefaultComboBoxModel&lt;DtAerolinea&gt; modeloAerolinea = new DefaultComboBoxModel&lt;&gt;();</span>
<span class="nc bnc" id="L160" title="All 2 branches missed.">        for (DtAerolinea a : sistema.getAerolineas()) {</span>
<span class="nc" id="L161">            modeloAerolinea.addElement(a);</span>
<span class="nc" id="L162">        }</span>
<span class="nc" id="L163">        campoAerolinea.setModel(modeloAerolinea);</span>
<span class="nc" id="L164">        campoAerolinea.setSelectedIndex(-1);</span>
<span class="nc" id="L165">    }</span>

    private void actualizarRutas() {
<span class="nc" id="L168">        DtAerolinea seleccionada = (DtAerolinea) campoAerolinea.getSelectedItem();</span>
<span class="nc" id="L169">        DefaultListModel&lt;DtRutaVuelo&gt; modeloRutas = new DefaultListModel&lt;&gt;();</span>
<span class="nc bnc" id="L170" title="All 2 branches missed.">        if (seleccionada != null) {</span>
<span class="nc bnc" id="L171" title="All 2 branches missed.">            for (DtRutaVuelo r : seleccionada.getRutas()) {</span>
<span class="nc" id="L172">                modeloRutas.addElement(r);</span>
<span class="nc" id="L173">            }</span>
        }
<span class="nc" id="L175">        campoRutaVuelo.setModel(modeloRutas);</span>
<span class="nc" id="L176">    }</span>



    private void cargarTipoAsiento() {
<span class="nc" id="L181">        DefaultComboBoxModel&lt;TipoAsiento&gt; modeloAsientos = new DefaultComboBoxModel&lt;&gt;();</span>
<span class="nc bnc" id="L182" title="All 2 branches missed.">        for (TipoAsiento t : TipoAsiento.values()) {</span>
<span class="nc" id="L183">            modeloAsientos.addElement(t);</span>
        }
<span class="nc" id="L185">        campoTipoAsiento.setModel(modeloAsientos);</span>
<span class="nc" id="L186">        campoTipoAsiento.setSelectedIndex(-1);</span>
<span class="nc" id="L187">    }</span>

    public Container getPanelDeSesion() {
<span class="nc" id="L190">        return JPanelAgregar;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>